# -*- coding: utf-8 -*-
"""Base_Dados_G3.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1xrFZdqBK5at1g-2ibzDAulpeeGOlvzKa
"""

from google.colab import drive
drive.mount('/content/drive')

import pandas as pd

tv_gazeta = pd.read_csv("/content/drive/MyDrive/2022-2A-T05/Grupo 3/Banco de Dados/CSV/TV Gazeta (GLO).csv", encoding="UTF-8")
tv_B = pd.read_csv("/content/drive/MyDrive/2022-2A-T05/Grupo 3/Banco de Dados/CSV/TV Tribuna (SBT).csv", encoding="UTF-8")
tv_C = pd.read_csv("/content/drive/MyDrive/2022-2A-T05/Grupo 3/Banco de Dados/CSV/TV Vitória (REC).csv", encoding="UTF-8")

print(tv_gazeta.head(5))
print(tv_B.head(5))
print(tv_C.head(5))

"""# Relação de Genero X Hora"""

import matplotlib.pyplot as plt
import csv
import pandas as pd

hour_to_number = {'06:00:00': 6, '06:05:00': 6, '06:10:00': 6, '06:15:00': 6.25, '06:20:00': 6.25, '06:25:00': 6.25, '06:30:00': 6.5, '06:35:00': 6.5, '06:40:00': 6.5, '06:45:00': 6.75, '06:50:00': 6.75, '06:55:00': 6.75, '07:00:00': 7, '07:05:00': 7, '07:10:00': 7, '07:15:00': 7.25, '07:20:00': 7.25, '07:25:00': 7.25, '07:30:00': 7.5, '07:35:00': 7.5, '07:40:00': 7.5, '07:45:00': 7.75, '07:50:00': 7.75, '07:55:00': 7.75, '08:00:00': 8, '08:05:00': 8, '08:10:00': 8, '08:15:00': 8.25, '08:20:00': 8.25, '08:25:00': 8.25, '08:30:00': 8.5, '08:35:00': 8.5, '08:40:00': 8.5, '08:45:00': 8.75, '08:50:00': 8.75, '08:55:00': 8.75, '09:00:00': 9, '09:05:00': 9, '09:10:00': 9, '09:15:00': 9.25, '09:20:00': 9.25, '09:25:00': 9.25, '09:30:00': 9.5, '09:35:00': 9.5, '09:40:00': 9.5, '09:45:00': 9.75, '09:50:00': 9.75, '09:55:00': 9.75, '10:00:00': 10, '10:05:00': 10, '10:10:00': 10, '10:15:00': 10.25, '10:20:00': 10.25, '10:25:00': 10.25, '10:30:00': 10.5, '10:35:00': 10.5, '10:40:00': 10.5, '10:45:00': 10.75, '10:50:00': 10.75, '10:55:00': 10.75, '11:00:00': 11, '11:05:00': 11, '11:10:00': 11, '11:15:00': 11.25, '11:20:00': 11.25, '11:25:00': 11.25, '11:30:00': 11.5, '11:35:00': 11.5, '11:40:00': 11.5, '11:45:00': 11.75, '11:50:00': 11.75, '11:55:00': 11.75, '12:00:00': 12, '12:05:00': 12, '12:10:00': 12, '12:15:00': 12.25, '12:20:00': 12.25, '12:25:00': 12.25, '12:30:00': 12.5, '12:35:00': 12.5, '12:40:00': 12.5, '12:45:00': 12.75, '12:50:00': 12.75, '12:55:00': 12.75, '13:00:00': 13, '13:05:00': 13, '13:10:00': 13, '13:15:00': 13.25, '13:20:00': 13.25, '13:25:00': 13.25, '13:30:00': 13.5, '13:35:00': 13.5, '13:40:00': 13.5, '13:45:00': 13.75, '13:50:00': 13.75, '13:55:00': 13.75, '14:00:00': 14, '14:05:00': 14, '14:10:00': 14, '14:15:00': 14.25, '14:20:00': 14.25, '14:25:00': 14.25, '14:30:00': 14.5, '14:35:00': 14.5, '14:40:00': 14.5, '14:45:00': 14.75, '14:50:00': 14.75, '14:55:00': 14.75, '15:00:00': 15, '15:05:00': 15, '15:10:00': 15, '15:15:00': 15.25, '15:20:00': 15.25, '15:25:00': 15.25, '15:30:00': 15.5, '15:35:00': 15.5, '15:40:00': 15.5, '15:45:00': 15.75, '15:50:00': 15.75, '15:55:00': 15.75, '16:00:00': 16, '16:05:00': 16, '16:10:00': 16, '16:15:00': 16.25, '16:20:00': 16.25, '16:25:00': 16.25, '16:30:00': 16.5, '16:35:00': 16.5, '16:40:00': 16.5, '16:45:00': 16.75, '16:50:00': 16.75, '16:55:00': 16.75, '17:00:00': 17, '17:05:00': 17, '17:10:00': 17, '17:15:00': 17.25, '17:20:00': 17.25, '17:25:00': 17.25, '17:30:00': 17.5, '17:35:00': 17.5, '17:40:00': 17.5, '17:45:00': 17.75, '17:50:00': 17.75, '17:55:00': 17.75, '18:00:00': 18, '18:05:00': 18, '18:10:00': 18, '18:15:00': 18.25, '18:20:00': 18.25, '18:25:00': 18.25, '18:30:00': 18.5, '18:35:00': 18.5, '18:40:00': 18.5, '18:45:00': 18.75, '18:50:00': 18.75, '18:55:00': 18.75, '19:00:00': 19, '19:05:00': 19, '19:10:00': 19, '19:15:00': 19.25, '19:20:00': 19.25, '19:25:00': 19.25, '19:30:00': 19.5, '19:35:00': 19.5, '19:40:00': 19.5, '19:45:00': 19.75, '19:50:00': 19.75, '19:55:00': 19.75, '20:00:00': 20, '20:05:00': 20, '20:10:00': 20, '20:15:00': 20.25, '20:20:00': 20.25, '20:25:00': 20.25, '20:30:00': 20.5, '20:35:00': 20.5, '20:40:00': 20.5, '20:45:00': 20.75, '20:50:00': 20.75, '20:55:00': 20.75, '21:00:00': 21, '21:05:00': 21, '21:10:00': 21, '21:15:00': 21.25, '21:20:00': 21.25, '21:25:00': 21.25, '21:30:00': 21.5, '21:35:00': 21.5, '21:40:00': 21.5, '21:45:00': 21.75, '21:50:00': 21.75, '21:55:00': 21.75, '22:00:00': 22, '22:05:00': 22, '22:10:00': 22, '22:15:00': 22.25, '22:20:00': 22.25, '22:25:00': 22.25, '22:30:00': 22.5, '22:35:00': 22.5, '22:40:00': 22.5, '22:45:00': 22.75, '22:50:00': 22.75, '22:55:00': 22.75, '23:00:00': 23, '23:05:00': 23, '23:10:00': 23, '23:15:00': 23.25, '23:20:00': 23.25, '23:25:00': 23.25, '23:30:00': 23.5, '23:35:00': 23.5, '23:40:00': 23.5, '23:45:00': 23.75, '23:50:00': 23.75, '23:55:00': 23.75, '24:00:00': 24, '24:05:00': 24, '24:10:00': 24, '24:15:00': 24.25, '24:20:00': 24.25, '24:25:00': 24.25, '24:30:00': 24.5, '24:35:00': 24.5, '24:40:00': 24.5, '24:45:00': 24.75, '24:50:00': 24.75, '24:55:00': 24.75, '25:00:00': 25, '25:05:00': 25, '25:10:00': 25, '25:15:00': 25.25, '25:20:00': 25.25, '25:25:00': 25.25, '25:30:00': 25.5, '25:35:00': 25.5, '25:40:00': 25.5, '25:45:00': 25.75, '25:50:00': 25.75, '25:55:00': 25.75, '26:00:00': 26, '26:05:00': 26, '26:10:00': 26, '26:15:00': 26.25, '26:20:00': 26.25, '26:25:00': 26.25, '26:30:00': 26.5, '26:35:00': 26.5, '26:40:00': 26.5, '26:45:00': 26.75, '26:50:00': 26.75, '26:55:00': 26.75, '27:00:00': 27, '27:05:00': 27, '27:10:00': 27, '27:15:00': 27.25, '27:20:00': 27.25, '27:25:00': 27.25, '27:30:00': 27.5, '27:35:00': 27.5, '27:40:00': 27.5, '27:45:00': 27.75, '27:50:00': 27.75, '27:55:00': 27.75, '28:00:00': 28, '28:05:00': 28, '28:10:00': 28, '28:15:00': 28.25, '28:20:00': 28.25, '28:25:00': 28.25, '28:30:00': 28.5, '28:35:00': 28.5, '28:40:00': 28.5, '28:45:00': 28.75, '28:50:00': 28.75, '28:55:00': 28.75, '29:00:00': 29, '29:05:00': 29, '29:10:00': 29, '29:15:00': 29.25, '29:20:00': 29.25, '29:25:00': 29.25, '29:30:00': 29.5, '29:35:00': 29.5, '29:40:00': 29.5, '29:45:00': 29.75, '29:50:00': 29.75, '29:55:00': 29.75}

tv_gazeta = tv_gazeta.replace({"Hora Início":hour_to_number})
tv_B = tv_B.replace({"Hora Início":hour_to_number})
tv_C = tv_C.replace({"Hora Início":hour_to_number})

avg_masc = tv_gazeta.groupby("Hora Início")["Masculino | Rat%"].agg('mean')
avg_fem = tv_gazeta.groupby("Hora Início")["Feminino | Rat%"].agg('mean')

fig, ax = plt.subplots()
fig.set_size_inches(20, 9)
plt.xlabel('Horário', labelpad=10)
plt.ylabel('%Rat', labelpad=20)
plt.plot(avg_masc, label="Masculino", color='purple')
plt.plot(avg_fem, label="Feminino", color='red')

plt.legend(loc='upper right')
plt.xticks(tv_gazeta['Hora Início'].unique(), rotation=90)
plt.show()

"""# Relação Idade X Hora"""

age_4_11 = tv_gazeta.groupby("Hora Início")["4-11 anos | Rat%"].agg('mean')
age_12_17 = tv_gazeta.groupby("Hora Início")["12-17 anos | Rat%"].agg('mean')
age_18_24 = tv_gazeta.groupby("Hora Início")["18-24 anos | Rat%"].agg('mean')
age_25_34 = tv_gazeta.groupby("Hora Início")["25-34 anos | Rat%"].agg('mean')
age_35_49 = tv_gazeta.groupby("Hora Início")["35-49 anos | Rat%"].agg('mean')
age_50_59 = tv_gazeta.groupby("Hora Início")["50-59 anos | Rat%"].agg('mean')
age_60 = tv_gazeta.groupby("Hora Início")["60+ anos | Rat%"].agg('mean')

fig, ax = plt.subplots()
fig.set_size_inches(18, 7)
plt.xlabel('Horário', labelpad=10)
plt.ylabel('%Rat', labelpad=20)
plt.plot(age_4_11, label="4-11 anos")
plt.plot(age_12_17, label="12-17 anos")
plt.plot(age_18_24, label="18-24 anos")
plt.plot(age_25_34, label="25-34 anos")
plt.plot(age_35_49, label="35-49 anos")
plt.plot(age_50_59, label="50-59 anos")
plt.plot(age_60, label="60+ anos")
plt.legend(loc='upper right')
plt.xticks(tv_gazeta['Hora Início'].unique(), rotation=90)
plt.show()

"""# Relação de Classe X Hora"""

tv_gazeta_AB = tv_gazeta.groupby("Hora Início")["AB | Rat%"].agg('mean')
tv_gazeta_C1 = tv_gazeta.groupby("Hora Início")["C1 | Rat%"].agg('mean')
tv_gazeta_C2 = tv_gazeta.groupby("Hora Início")["C2 | Rat%"].agg('mean')
tv_gazeta_DE = tv_gazeta.groupby("Hora Início")["DE | Rat%"].agg('mean')

fig, ax = plt.subplots()
fig.set_size_inches(18, 7)
plt.xlabel('Horário', labelpad=10)
plt.ylabel('%Rat', labelpad=20)
plt.plot(tv_gazeta_AB, label="AB | Rat%")
plt.plot(tv_gazeta_C1, label="C1 | Rat%")
plt.plot(tv_gazeta_C2, label="C2 | Rat%")
plt.plot(tv_gazeta_DE, label="DE | Rat%")

plt.legend(loc='upper right')
plt.xticks(tv_gazeta['Hora Início'].unique(), rotation=90)
plt.show()

"""# Comparação com Concorrentes - Com Base em Horários"""

tv_gazeta_domicilios = tv_gazeta.groupby("Hora Início")["Total Domicílios | Rat%"].agg('mean')
tv_B_domicilios = tv_B.groupby("Hora Início")["Total Domicílios | Rat%"].agg('mean')
tv_C_domicilios = tv_C.groupby("Hora Início")["Total Domicílios | Rat%"].agg('mean')

fig, ax = plt.subplots()
fig.set_size_inches(18, 7)
plt.xlabel('Horário', labelpad=10)
plt.ylabel('%Rat', labelpad=20)
plt.plot(tv_gazeta_domicilios, label="tv_gazeta_domicilios")
plt.plot(tv_B_domicilios, label="tv_B_domicilios")
plt.plot(tv_C_domicilios, label="tv_C_domicilios")
plt.legend(loc='upper right')
plt.xticks(tv_gazeta['Hora Início'].unique(), rotation=90)
plt.show()

"""# Relações de Categoria X Hora"""

tv_gazeta_categoria = tv_gazeta.groupby("Categoria")["Total Domicílios | Rat%"].agg('mean')

fig, ax = plt.subplots()
fig.set_size_inches(18, 7)
plt.xlabel('Horário', labelpad=10)
plt.ylabel('%Rat', labelpad=20)
plt.plot(tv_gazeta_categoria, label="tv_gazeta_categoria")
plt.legend(loc='upper right')
plt.xticks(tv_gazeta['Categoria'].unique(), rotation=90)
plt.show()

tv_gazeta_mes = tv_gazeta.groupby("Categoria")["Total Domicílios | Rat%"].agg('mean')
tv_gazeta_mes_fem = tv_gazeta.groupby("Categoria")["Feminino | Rat%"].agg('mean')
tv_gazeta_mes_mas = tv_gazeta.groupby("Categoria")["Masculino | Rat%"].agg('mean')

fig, ax = plt.subplots()
fig.set_size_inches(18, 7)
plt.xlabel('Categoria', labelpad=10)
plt.ylabel('%Rat', labelpad=20)
plt.plot(tv_gazeta_mes, label="TV Gazeta")
plt.plot(tv_gazeta_mes_fem, label="Feminino")
plt.plot(tv_gazeta_mes_mas, label="Masculino")
plt.legend(loc='upper right')
plt.xticks(tv_gazeta['Categoria'].unique(), rotation=90)
plt.show()

tv_gazeta_mes = tv_gazeta.groupby("Mês")["Total Domicílios | Rat%"].agg('mean')

fig, ax = plt.subplots()
fig.set_size_inches(18, 7)
plt.xlabel('Mês', labelpad=10)
plt.ylabel('%Rat', labelpad=20)
plt.plot(tv_gazeta_mes, label="TV Gazeta")
plt.legend(loc='upper right')
plt.xticks(tv_gazeta['Mês'].unique(), rotation=90)
plt.show()